{"ast":null,"code":"export default {\n  data() {\n    return {\n      selectedVoteType: '',\n      selectedOption: '',\n      campaigns: [{\n        id: 1,\n        name: 'Project Vote'\n      }, {\n        id: 2,\n        name: 'People Vote'\n      }, {\n        id: 3,\n        name: 'Product Vote'\n      }],\n      selectedCampaignId: '',\n      selectedCampaignName: '',\n      selectedOptionName: '',\n      hasVoted: false,\n      voteTypeMap: {\n        project: 'Project',\n        people: 'People',\n        product: 'Product'\n      },\n      options: [],\n      votedOptions: {}\n    };\n  },\n  watch: {\n    '$route.params.type': {\n      immediate: true,\n      handler(newType) {\n        this.selectedVoteType = newType;\n        this.fetchOptions();\n        this.loadVotedOption();\n      }\n    }\n  },\n  methods: {\n    fetchOptions() {\n      // ... (保持不变)\n    },\n    submitVote() {\n      const campaign = this.campaigns.find(c => c.name.toLowerCase() === this.selectedVoteType);\n      if (campaign) {\n        this.selectedCampaignId = campaign.id;\n        this.selectedCampaignName = campaign.name;\n      } else {\n        console.error(`未找到与投票类型 \"${this.selectedVoteType}\" 匹配的活动`);\n        return;\n      }\n      const selectedOption = this.options.find(option => option.id === this.selectedOption);\n      if (selectedOption) {\n        this.selectedOptionName = selectedOption.name;\n      } else {\n        console.error(`未找到与选项 ID \"${this.selectedOption}\" 匹配的选项`);\n        return;\n      }\n      this.hasVoted = true;\n      this.saveVotedOption();\n      this.$emit('vote-submitted');\n    },\n    saveVotedOption() {\n      this.votedOptions[this.selectedVoteType] = {\n        selectedOption: this.selectedOption,\n        selectedOptionName: this.selectedOptionName,\n        selectedCampaignId: this.selectedCampaignId,\n        selectedCampaignName: this.selectedCampaignName\n      };\n    },\n    loadVotedOption() {\n      if (this.votedOptions[this.selectedVoteType]) {\n        const {\n          selectedOption,\n          selectedOptionName,\n          selectedCampaignId,\n          selectedCampaignName\n        } = this.votedOptions[this.selectedVoteType];\n        this.selectedOption = selectedOption;\n        this.selectedOptionName = selectedOptionName;\n        this.selectedCampaignId = selectedCampaignId;\n        this.selectedCampaignName = selectedCampaignName;\n        this.hasVoted = true;\n      } else {\n        this.resetForm();\n      }\n    },\n    resetForm() {\n      this.selectedOption = '';\n      this.selectedOptionName = '';\n      this.selectedCampaignId = '';\n      this.selectedCampaignName = '';\n      this.hasVoted = false;\n    }\n  }\n};","map":{"version":3,"names":["data","selectedVoteType","selectedOption","campaigns","id","name","selectedCampaignId","selectedCampaignName","selectedOptionName","hasVoted","voteTypeMap","project","people","product","options","votedOptions","watch","immediate","handler","newType","fetchOptions","loadVotedOption","methods","submitVote","campaign","find","c","toLowerCase","console","error","option","saveVotedOption","$emit","resetForm"],"sources":["/Users/wangxiao/voting_front/src/components/VotePage.vue"],"sourcesContent":["<!-- VotePage.vue -->\n<template>\n  <div class=\"vote-page\">\n    <div v-if=\"selectedVoteType\">\n      <h2>请为你喜欢的{{ voteTypeMap[selectedVoteType] }}投票</h2>\n      <div class=\"vote-form\">\n        <select v-model=\"selectedOption\" :disabled=\"hasVoted\" class=\"vote-select\">\n          <option value=\"\" disabled>请选择</option>\n          <option v-for=\"option in options\" :key=\"option.id\" :value=\"option.id\">\n            {{ option.name }}\n          </option>\n        </select>\n        <button @click=\"submitVote\" :disabled=\"hasVoted\" class=\"vote-button\">Vote</button>\n      </div>\n      <p v-if=\"hasVoted\">您已为 {{ selectedCampaignName }} 投票,选项为:{{ selectedOptionName }}</p>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      selectedVoteType: '',\n      selectedOption: '',\n      campaigns: [\n        { id: 1, name: 'Project Vote' },\n        { id: 2, name: 'People Vote' },\n        { id: 3, name: 'Product Vote' }\n      ],\n      selectedCampaignId: '',\n      selectedCampaignName: '',\n      selectedOptionName: '',\n      hasVoted: false,\n      voteTypeMap: {\n        project: 'Project',\n        people: 'People',\n        product: 'Product'\n      },\n      options: [],\n      votedOptions: {}\n    };\n  },\n  watch: {\n    '$route.params.type': {\n      immediate: true,\n      handler(newType) {\n        this.selectedVoteType = newType;\n        this.fetchOptions();\n        this.loadVotedOption();\n      }\n    }\n  },\n  methods: {\n    fetchOptions() {\n      // ... (保持不变)\n    },\n    submitVote() {\n      const campaign = this.campaigns.find(c => c.name.toLowerCase() === this.selectedVoteType);\n\n      if (campaign) {\n        this.selectedCampaignId = campaign.id;\n        this.selectedCampaignName = campaign.name;\n      } else {\n        console.error(`未找到与投票类型 \"${this.selectedVoteType}\" 匹配的活动`);\n        return;\n      }\n\n      const selectedOption = this.options.find(option => option.id === this.selectedOption);\n\n      if (selectedOption) {\n        this.selectedOptionName = selectedOption.name;\n      } else {\n        console.error(`未找到与选项 ID \"${this.selectedOption}\" 匹配的选项`);\n        return;\n      }\n\n      this.hasVoted = true;\n      this.saveVotedOption();\n      this.$emit('vote-submitted');\n    },\n    saveVotedOption() {\n      this.votedOptions[this.selectedVoteType] = {\n        selectedOption: this.selectedOption,\n        selectedOptionName: this.selectedOptionName,\n        selectedCampaignId: this.selectedCampaignId,\n        selectedCampaignName: this.selectedCampaignName\n      };\n    },\n    loadVotedOption() {\n      if (this.votedOptions[this.selectedVoteType]) {\n        const { selectedOption, selectedOptionName, selectedCampaignId, selectedCampaignName } = this.votedOptions[this.selectedVoteType];\n        this.selectedOption = selectedOption;\n        this.selectedOptionName = selectedOptionName;\n        this.selectedCampaignId = selectedCampaignId;\n        this.selectedCampaignName = selectedCampaignName;\n        this.hasVoted = true;\n      } else {\n        this.resetForm();\n      }\n    },\n    resetForm() {\n      this.selectedOption = '';\n      this.selectedOptionName = '';\n      this.selectedCampaignId = '';\n      this.selectedCampaignName = '';\n      this.hasVoted = false;\n    }\n  }\n};\n</script>\n\n  \n  <style scoped>\n  .vote-form {\n    display: flex;\n    align-items: center;\n    margin-bottom: 20px;\n  }\n  \n  .vote-select {\n    margin-right: 20px;\n  }\n  \n  .vote-button {\n    background-color: #007bff;\n    color: #fff;\n    border: none;\n    padding: 10px 20px;\n    cursor: pointer;\n  }\n  \n  .vote-button:disabled {\n    background-color: #ccc;\n    cursor: not-allowed;\n  }\n  \n  select:disabled {\n    background-color: #f0f0f0;\n  }\n  </style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}